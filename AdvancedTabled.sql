DROP TABLE IF EXISTS OrderProduct;
DROP TABLE IF EXISTS `Client`;
DROP TABLE IF EXISTS `Order`;
DROP TABLE IF EXISTS Product;
CREATE TABLE Product
(
	ID INT,
	Name VARCHAR(255),
	Price DECIMAL(6,2),
	
	PRIMARY KEY (ID)
);
CREATE TABLE `Client`(
	ID INT,
	FirstName VARCHAR(255),
	LastName VARCHAR(255),
	AccountCreated DATE,
	
	PRIMARY KEY (ID)
);
CREATE TABLE `Order`(
	ID INT,
	OrderedOn DATE,
	ClientID INT,
	
	PRIMARY KEY (ID),
	FOREIGN KEY (ClientID) REFERENCES `Client`(ID)
);
CREATE TABLE OrderProduct(
	OrderID INT,
	ProductID INT,
	Quantity INT,
	
	PRIMARY KEY (OrderID, ProductID),
	FOREIGN KEY (OrderID) REFERENCES `Order`(ID),
	FOREIGN KEY (ProductID) REFERENCES Product(ID)
);
INSERT INTO `Client` VALUES
(1, 'John', 'Mandrake', '2021-11-23'),
(2, 'Kathleen', 'Jones', '2020-04-01'),
(3, 'Arther', 'Penhaligon', '2022-06-17'),
(4, 'Annabeth', 'Chase', '2022-10-11'),
(5, 'Tiberius', 'Balthasar', '2021-01-26'),
(6, 'Amity', 'Blight', '2022-10-11'),
(7, 'Henry', 'Smith', '2022-01-01'),
(8, 'Emma', 'Jones', '2022-06-07'),
(9, 'Olivia', 'Williams', '2022-09-13'),
(10, 'Ava', 'Brown', '2021-01-26'),
(11, 'Isabella', 'Davis', '2020-11-05'),
(12, 'Sophia', 'Miller', '2023-01-06'),
(13, 'Abigail', 'Wilson', '2022-01-07'),
(14, 'Emily', 'Moore', '2021-12-08'),
(15, 'Elizabeth', 'Taylor', '2022-08-20'),
(16, 'Mia', 'Anderson', '2021-02-10'),
(17, 'Chloe', 'Thomas', '2022-01-21'),
(18, 'Victoria', 'Jackson', '2021-01-02'),
(19, 'Aria', 'White', '2022-01-13'),
(20, 'Scarlett', 'Harris', '2022-01-24'),
(21, 'Grace', 'Martin', '2022-01-14'),
(22, 'Hannah', 'Thompson', '2021-01-16'),
(23, 'Amelia', 'Garcia', '2022-01-19'),
(24, 'Sofia', 'Martinez', '2020-01-18'),
(25, 'Natalie', 'Robinson', '2022-01-06'),
(26, 'Avery', 'Clark', '2022-01-11'),
(27, 'Zoe', 'Rodriguez', '2021-01-21'),
(28, 'Addison', 'Lewis', '2022-01-18'),
(29, 'Lily', 'Lee', '2022-01-21'),
(30, 'Ella', 'Walker', '2022-01-10'),
(31, 'Nora', 'Hall', '2022-01-14'),
(32, 'Hazel', 'Allen', '2022-01-16'),
(33, 'Brooklyn', 'Young', '2022-01-08'),
(34, 'Aubrey', 'King', '2022-01-25'),
(35, 'Zara', 'Wright', '2022-01-19'),
(36, 'Leah', 'Lopez', '2022-01-07'),
(37, 'Savannah', 'Hill', '2022-01-01');
INSERT INTO Product VALUES
(1, 'Healing Potion', 79.99),
(2, 'Training Wand', 150.00),
(3, 'Staff of Power', 9999.99),
(4, 'Scroll of Fire', 199.99),
(5, 'Elixir of Immortality', 8550.00),
(6, 'Snail', 1.50),
(7, 'Broom Stick', 499.99),
(8, 'Charm of Luck', 99.50),
(9, 'Petrified Gorgon Eye', 499.50),
(10, 'Golden Apple', 199.99),
(11, 'Demon\'s Bane', 449.50),
(12, 'Sorcerer\'s Stone', 999.99),
(13, 'Ring of Invisibility', 749.99),
(14, 'Amulet of Protection', 199.00),
(15, 'Cloak of Shadows', 199.50),
(16, 'Boots of Speed', 459.99),
(17, 'Gauntlets of Strength', 199.50),
(18, 'Helm of Courage', 1099.00),
(19, 'Shield of Defense', 479.50),
(20, 'Bow of Accuracy', 299.99),
(21, 'Arrow of Fire', 9.99),
(22, 'Dagger of Poison', 89.50),
(23, 'Sword of Truth', 829.50),
(24, 'Hammer of Justice', 449.50),
(25, 'Axe of Fury', 359.00),
(26, 'Spear of War', 239.50),
(27, 'Mace of Dominion', 1109.00),
(28, 'Flail of Destruction', 149.50);
INSERT INTO `Order` VALUES
(1, '2021-12-01', 1),
(2, '2022-08-20', 1),
(3, '2022-07-08', 2),
(4, '2022-02-14', 3),
(5, '2022-09-19', 4),
(6, '2022-04-07', 5),
(7, '2021-09-26', 6),
(8, '2022-10-21', 6),
(9, '2021-02-05', 6),
(10, '2021-06-01', 7),
(11, '2022-02-20', 7),
(12, '2022-07-08', 8),
(13, '2022-02-14', 8),
(14, '2022-09-19', 8),
(15, '2021-04-07', 9),
(16, '2022-09-26', 10),
(17, '2022-02-05', 10),
(18, '2021-12-01', 11),
(19, '2022-08-20', 12),
(20, '2021-12-14', 12),
(21, '2022-05-17', 13),
(22, '2022-11-23', 13),
(23, '2021-01-26', 13),
(24, '2022-06-17', 15),
(25, '2021-11-03', 15),
(26, '2021-07-02', 16),
(27, '2022-08-15', 17),
(28, '2021-09-09', 17),
(29, '2022-04-01', 17),
(30, '2022-01-23', 18),
(31, '2022-07-27', 18),
(32, '2021-05-31', 19),
(33, '2022-03-06', 19),
(34, '2022-09-03', 20),
(35, '2021-08-21', 20),
(36, '2022-05-13', 21),
(37, '2022-01-17', 21),
(38, '2021-10-30', 22),
(39, '2021-08-21', 24),
(40, '2022-09-03', 24),
(41, '2022-03-06', 24),
(42, '2021-05-31', 25),
(43, '2022-07-27', 26),
(44, '2022-01-23', 26),
(45, '2022-04-01', 27),
(46, '2021-09-09', 28),
(47, '2022-08-15', 28),
(48, '2021-07-02', 29),
(49, '2021-11-03', 29),
(50, '2022-06-17', 29),
(51, '2021-03-11', 30),
(52, '2022-10-11', 30),
(53, '2021-11-03', 31),
(54, '2022-06-17', 31),
(55, '2022-02-05', 32),
(56, '2022-09-26', 33),
(57, '2021-12-01', 33),
(58, '2022-02-14', 33),
(59, '2022-02-20', 35),
(60, '2021-06-01', 35),
(61, '2021-12-14', 36),
(62, '2022-08-20', 36),
(63, '2022-05-17', 37);
INSERT INTO OrderProduct VALUES
(1, 3, 1),
(1, 2, 5),
(1, 5, 1),
(2, 1, 10),
(2, 2, 3),
(3, 4, 2),
(4, 7, 1),
(5, 5, 2),
(6, 1, 7),
(6, 4, 3),
(7, 6, 9),
(7, 3, 1),
(8, 6, 18),
(9, 6, 6),
(10, 5, 2),
(10, 17, 1),
(11, 28, 3),
(12, 23, 2),
(12, 4, 1),
(13, 19, 14),
(14, 21, 3),
(14, 18, 2),
(15, 25, 12),
(15, 8, 1),
(16, 11, 2),
(16, 27, 1),
(17, 14, 2),
(17, 16, 1),
(17, 1, 2),
(18, 13, 6),
(19, 26, 2),
(19, 24, 3),
(20, 22, 2),
(20, 6, 1),
(21, 28, 2),
(21, 18, 1),
(22, 6, 3),
(22, 16, 2),
(23, 4, 2),
(23, 25, 1),
(24, 19, 2),
(24, 14, 1),
(25, 26, 3),
(25, 21, 2),
(26, 17, 2),
(26, 8, 1),
(27, 24, 2),
(27, 27, 1),
(28, 15, 2),
(28, 16, 1),
(29, 11, 4),
(30, 20, 2),
(30, 23, 10),
(31, 14, 1),
(32, 25, 2),
(32, 4, 1),
(33, 26, 3),
(33, 17, 2),
(34, 6, 2),
(34, 8, 1),
(35, 21, 2),
(35, 11, 9),
(36, 28, 1),
(37, 13, 2),
(37, 27, 5),
(38, 24, 1),
(39, 18, 3),
(40, 20, 1),
(40, 2, 1),
(40, 7, 1),
(40, 22, 1),
(41, 25, 1),
(42, 28, 3),
(42, 16, 2),
(43, 6, 2),
(43, 18, 1),
(44, 21, 1),
(45, 14, 3),
(46, 15, 2),
(47, 24, 2),
(47, 13, 1),
(48, 19, 2),
(48, 8, 1),
(49, 17, 2),
(50, 22, 1),
(51, 4, 1),
(52, 25, 2),
(52, 18, 1),
(53, 21, 2),
(54, 16, 2),
(54, 26, 1),
(55, 27, 1),
(56, 15, 2),
(56, 11, 1),
(57, 8, 1),
(58, 13, 1),
(59, 23, 1),
(60, 20, 2),
(61, 4, 2),
(61, 16, 1),
(62, 18, 2),
(63, 6, 2),
(63, 21, 4),
(64, 26, 2),
(64, 25, 1),
(65, 27, 6),
(66, 15, 2),
(66, 11, 1),
(67, 24, 7),
(68, 19, 2),
(68, 8, 1),
(68, 3, 2),
(69, 17, 2),
(69, 23, 4),
(70, 20, 2),
(70, 22, 1);

-- Search Queries
-- 1
SELECT DISTINCT Product.Name FROM Product
INNER JOIN OrderProduct ON Product.ID = OrderProduct.ProductID
INNER JOIN `Order` ON OrderProduct.OrderID = `Order`.ID
INNER JOIN `Client` ON `Order`.ClientID = `Client`.ID
WHERE `Client`.ID = 1;

-- 2
SELECT DISTINCT Client.FirstName, Client.LastName FROM Client
INNER JOIN `Order` ON Client.ID = `Order`.ClientID
INNER JOIN OrderProduct ON `Order`.ID = OrderProduct.OrderID
INNER JOIN Product ON OrderProduct.ProductID = Product.ID
WHERE Product.Name LIKE 'S%';

-- 3
SELECT Client.FirstName, Client.LastName FROM Client
LEFT JOIN `Order` ON Client.ID = `Order`.ClientID
WHERE `Order`.ClientID IS NULL;

-- 4
SELECT Product.Name FROM Product
LEFT JOIN OrderProduct ON Product.ID = OrderProduct.ProductID
WHERE OrderProduct.ProductID IS NULL;

-- 5
SELECT Product.Name, SUM(OrderProduct.Quantity) AS OrderCount FROM Product
LEFT JOIN OrderProduct ON Product.ID = OrderProduct.ProductID
GROUP BY Product.Name;